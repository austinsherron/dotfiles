{{- if eq .chezmoi.os "darwin" -}}
#!/usr/bin/env bash

set -Eeuo pipefail

source /etc/profile.d/shared_paths.sh


{{ template "version-check.tmpl" (merge . (dict "type" "darwin" "script" "D_install_packages__darwin")) }}

# NOTE: at the time of writing, go packages must be installed after scripts due to
# dependency on gvm

{{ if (index .packages.darwin "scripts") }} 
{{ template "scripts-install.tmpl" .packages.darwin.scripts }} 
{{ end }}

{{ if (index .packages.darwin "go") }} 
{{ template "go-install.tmpl" .packages.darwin.go }}
{{ end }}

{{ if (index .packages.darwin "luarocks") }} 
{{ template "luarocks-install.tmpl" .packages.darwin.luarocks }}
{{ end }}

{{- end }}
